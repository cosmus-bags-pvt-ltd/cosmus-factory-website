{% extends 'product/base.html' %} 
{% load static %} 

{% block body %}

<form method="POST">
    {% csrf_token %}

    <div class="mb-3 mt-2">
        <div class="d-flex">
            <input type="hidden" id="picklistHiddenData" value="">
         <div class="">
            <label for="id_pickList_no" class="fw-bold">Add Picklist+ :</label>
            {% if master_form.instance.id %}
            <input type="text" name="pickList_no" class="purchase-mark ms-1" id="id_pickList_no" readonly>
            {% elif not master_form.instance.id %}
            <input type="text" name="pickList_no" class="purchase-mark  ms-1" id="id_pickList_no">
            {% endif %}

            <label for="id_outward_no" class="fw-bold me-1">Outward No :</label>
            {% if master_form.instance.id %}
            <input type="text" name="outward_no" class="purchase-vNo ms-2" id="id_outward_no">
            {% elif not master_form.instance.id %} 
            <input type="text" name="outward_no" class="purchase-vNo ms-2" value="{{ master_form.outward_no.initial }}" id="id_outward_no" required>
            {% endif %}

            <label for="inwordSerialNo" class="fw-bold me-1">Scan :</label>
            <input type="text" name="scanned_serial_number" class="item-selects ms-3" id="inwordSerialNo">
            <label for="id_manualSerialNo" class="fw-bold ms-1">M-Scan :</label>
            <input type="text" name="manual_serial_number" class="item-selects ms-3" id="id_manualSerialNo">
       </div>
         <div class=""> 
            <span id="responseMessage" class="ms-3 fw-bold"></span></div>
        </div>
    </div>
    <div>
        <div class="row">
            <div class="col-lg-2">
                <table class="table table-striped table-hover table-bordered table-warning" id="piclistTable">
                    <thead class="name_absolute">
                        <tr>
                            <th>Pick No</th>
                            <th>Qty</th>
                            <th>Balance</th>
                            <th>check</th>
                        </tr>
                    </thead>
                    <tbody class="mainTableList">
                       
                    </tbody>
                </table>
            </div>
        </div>
        
    </div>   
    
    <table class="table table-striped table-hover table-bordered" id="outwardSales">
        <thead class="name_absolute">
            <tr>
                <th>No</th>
                <th>Ref No</th>
                <th>Model Name</th>
                <th>Color</th>
                <th>Sku</th>
                <th>Image</th>
                <th>Serial No</th>
                <th>Bin</th>
                <th>Quantity</th>
                <th>Delete</th>
            </tr>
        </thead>
        <tbody class="mainTableList">
            {{ formset.management_form }}
            {% for form in formset %}
            {{form.id}}
            <tr>
                <input type="hidden" name="picklistNo_{{forloop.counter0}}" id="id_picklistNo_{{forloop.counter0}}" value="">
                <td><input type="number" class="rowNo purchase-mark bg-transparent border-0" name="rowNo_{{forloop.counter0}}" id="rowNo_{{forloop.counter0}}" value="{{forloop.counter}}"></td>
                <td><input type="text" name="{{form.prefix}}-product_RefNo" id="id_{{form.prefix}}-product_RefNo" class=" purchase-amount" value="" readonly > </td>
                <td>  
                    <input type="text" name="{{form.prefix}}-product_name_value" id="id_{{form.prefix}}-product_name_Value" class="productpurchaseInvoice search-input"  placeholder="Product Name" value="" readonly > 
                  
                </td>
                <td><input type="text" name="product_color_{{forloop.counter0}}" id="product_color_{{forloop.counter0}}" value="" class="purchase-input" style="margin-left: 10px;" readonly></td>

                <td><input type="text" name="{{form.prefix}}-product" id="id_{{form.prefix}}-product" value="" class="purchase-amount" readonly></td>
            
                <td><img src="" id="product_img_{{forloop.counter0}}"  style="width: 30px; height: 30px; cursor: pointer;" alt="product"  onclick="showLargeImage(this.src)"></td>
                <td> <input type="text" name="{{form.prefix}}-unique_serial_no" maxlength="25" id="id_{{form.prefix}}-unique_serial_no" class="purchase-amount" readonly></td>
                <td><input type="text" name="{{form.prefix}}-bin_no" id="id_{{form.prefix}}-bin_no" class="purchase-amount" readonly>
                    <input type="hidden" name="{{form.prefix}}-bin_number" id="id_{{form.prefix}}-bin_number" class="purchase-amount" readonly></td>
                <td> <input type="number" name="{{form.prefix}}-quantity" value="" id="id_{{form.prefix}}-quantity" class="purchase-input" readonly></td>
                <td><span class="delete-btn border-0 bg-transparent" style="cursor: pointer;"><i class="fa-solid fa-trash text-danger px-3 py-2 fs-6"><input type="checkbox" class="godown_deleteId px-2" style="display: none;"  name="{{form.prefix}}-DELETE" id="id_{{form.prefix}}-DELETE" value="" ></i></span></td>  
            </tr>

            {% endfor %}

        </tbody>
    </table>

        
 
    <button type="submit" class="ms-3 newProductCreateBtn" id="parentFormClick">Generate</button>
</form>

<div id="customModal" style="display:none; position:fixed; top:0; left:0; height:100%; background:rgba(34, 34, 34, 0.9); display:flex; align-items:center; justify-content:center;">
    <img id="modalImg" style="max-width:60%; max-height:60%; cursor:pointer;">
</div>

<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">PickList Products</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <table class="table table-bordered " id="picklistProductTable">
                <thead class="name_absolute">
                    <tr>
                        <th>Model Name</th>
                        <th>Sku</th>
                        <th>Color</th>
                        <th>Qty</th>
                        <th>Balance</th>
                       
                    </tr>
                </thead>
                <tbody class="mainTableList">

                </tbody>
            </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="filterButton" data-bs-dismiss="modal">Close</button>
        
        </div>
      </div>
    </div>
  </div>



<script>

$(document).ready(function () {
    // Event listener for when the picklist number is entered
    $('#id_pickList_no').on('blur', function () { // Trigger when focus is lost
        var picklistNo = parseInt($(this).val());
        console.log(picklistNo);

        // Only proceed if picklistNo is valid
        if (picklistNo) {
            $.ajax({
                url: '/outwardpicklistnoajax/',
                method: 'GET',
                data: { "picklistNo": picklistNo },
                success: function (response) {
                    var productPickList = response.picklistDict;
                    console.log(productPickList);

                    if (response.picklistDict && response.picklisQty !== null) {
                        var picklistKey = Object.keys(response.picklistDict)[0]; // Get the first key dynamically
                        var picklistData = response.picklistDict[picklistKey]; // Get the data for that key

                        // Retrieve existing data from the hidden field or initialize empty array
                        var hiddenData = $('#picklistHiddenData').val();
                        var currentData = hiddenData ? JSON.parse(hiddenData) : {};

                        if (!Array.isArray(currentData[picklistKey])) {
                            currentData[picklistKey] = []; // Initialize as empty array if it doesn't exist
                            }

                            // Append all items to the array
                            picklistData.forEach(item => {
                                currentData[picklistKey].push({
                                    sku: item.sku,
                                    model_name: item.model_name,
                                    color: item.color,
                                    qty: item.qty
                                });
                            });
                        // Update the hidden input field with the new data
                        $('#picklistHiddenData').val(JSON.stringify(currentData));
                        
                        
                        // Optionally, dynamically display the data (e.g., in a table or UI)
                        var tables = $('#piclistTable .mainTableList');
                        var row = $(`
                            <tr>
                                <td><span class="pickId">${response.picklistNo}</span></td>
                                <td>
                                    <button type="button" class="item-btn" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                                        <span class="pickQty">${response.picklisQty}</span>
                                    </button>
                                </td>
                                <td><span class="pickBalance"></span></td>
                                <td><input type="radio" class="picklistRadio" name="picklistRadio"></td>
                            </tr>
                        `);
                        tables.append(row);
                    }
                },
                error: function (error) {
                    console.log(error);
                }
            });
        }
    });

    // Event listener for button click to retrieve data from localStorage
    $(document).on('click', 'button.item-btn', function () {
    var productTable = $('#picklistProductTable .mainTableList');
    productTable.empty(); // Clear the table before appending new data

    var productKey = $(this).closest('tr').find('.pickId').text().trim(); // Picklist Number
    var storedData = $('#picklistHiddenData').val();

    if (!storedData) {
        console.log("No picklist data found in localStorage.");
        return;
    }

    var parsedData = JSON.parse(storedData);
    console.log('Parsed Data:', parsedData);

    if (!parsedData.hasOwnProperty(productKey) || !Array.isArray(parsedData[productKey])) {
        console.warn("No data found for this picklistNo:", productKey);
        return;
    }

    var totalQty = {}; // Object to accumulate total quantities per SKU

    var productSingSku = $('[name$="-product"]'); // Get all SKUs in the form

    productSingSku.each(function () {
        var sku = $(this).val().trim(); // SKU from form input
        var row = $(this).closest('tr');
        var pickNos = row.find('[name^="picklistNo_"]').val()?.trim(); // Picklist number from form
        var qty = parseInt(row.find('[name$="-quantity"]').val()) || 0; // Get quantity

        console.log('Form SKU:', sku);
        console.log('Form Picklist No:', pickNos);

        if (!pickNos) {
            console.warn('Picklist No is undefined in form.');
            return;
        }

        if (productKey === pickNos) {
            if (!totalQty[sku]) {
                totalQty[sku] = 0;
            }
            totalQty[sku] += qty; // Accumulate total quantity for each SKU
        }
    });

    console.log('Total Quantities:', totalQty);

    // Now update only the `balanceqty` for the matching SKU
    parsedData[productKey].forEach(item => {
        if (totalQty[item.sku]) {
            item.qty -= totalQty[item.sku]; // Subtract total outward quantity

            var newRow = $(`
                <tr class="picklistRow" data-sku="${item.sku}" data-picklistno="${productKey}">
                    <td><span class="modelName">${item.model_name}</span></td>
                    <td><span class="sku">${item.sku}</span></td>
                    <td><span class="color">${item.color}</span></td>
                    <td><span class="qty">${item.qty + totalQty[item.sku]}</span></td>
                    <td><span class="balanceqty">${item.qty}</span></td> 
                </tr>
            `);

            productTable.append(newRow);
        }
    });
});

});




// image priview on click on image 
document.body.appendChild(document.getElementById('staticBackdrop'));
document.body.appendChild(document.getElementById('customModal'));
    function showLargeImage(src) {
     let modal = document.getElementById("customModal");
     let modalImg = document.getElementById("modalImg");

     modalImg.src = src;
     modal.style.display = "flex";
     modal.style.width = '100%'
     // Clicking anywhere outside the image will close the modal
     modal.onclick = function() {
         modal.style.display = "none";
     };
 }
</script>
<script>

$(document).ready(function () {
    let debounceTimeout;

    $('#inwordSerialNo').on('input', function () {
        clearTimeout(debounceTimeout);
        const manual_serial = $('#id_manualSerialNo');
        manual_serial.val('');

        const responseMessage = $('#responseMessage');
        responseMessage.html(''); // Clear any previous messages

        const inputField = $(this);

        debounceTimeout = setTimeout(async function () {
            let inputUrl = inputField.val();
            let serialNo = '';

            if (inputUrl.includes('=')) {
                serialNo = inputUrl.split('=').pop();
                inputField.val(serialNo);
                inputField.css('color', 'black');
            }

            if (serialNo) {
                try {
                    const response = await sendSerialNumber(serialNo);
                    $('#responseMessage').html('<span class="text-success">' + response.message + '</span>');
                } catch (error) {
                    const errorMessage = error.responseJSON?.error || 'An unexpected error occurred.';
                    $('#responseMessage').html('<span class="text-danger">' + errorMessage + '</span>');
                }
            }
        }, 500);
    });

    $('#id_manualSerialNo').on('input', function () {
           // Clear inwordSerialNo
           $('#inwordSerialNo').val('');
   
           const responseMessage = $('#responseMessage');
           responseMessage.html(''); // Clear any previous messages

       });

       $('#id_manualSerialNo').on('keydown', async function (event) {
            if(event.key === 'Enter'){
                event.preventDefault();
                const manualSerialNo = $('#id_manualSerialNo').val();
                const responseMessage = $('#responseMessage'); // Response message container
                    if (manualSerialNo) {
                        try {
                            const response = await sendSerialNumber(manualSerialNo);
                            
                            $('#responseMessage').html('<span class="text-success">' + response.message + '</span>');
                            $('#id_manualSerialNo').val('');
                           
                        } catch (error) {
                            const errorMessage = error.responseJSON?.message || 'An unexpected error occurred.';
                            $('#responseMessage').html('<span class="text-danger">' + errorMessage + '</span>');
                            $('#id_manualSerialNo').val('');
                        }
                    } else {
                        $('#responseMessage').html('<span class="text-danger">Please enter a Manual Serial Number.</span>');
                        $('#id_manualSerialNo').val('');
                    }
                    
            }
           

       });

    function populateRow(row, productResponse) {
      
        row.find('[name$="-product_RefNo"]').val(productResponse[0]);
        row.find('[name$="-product_name_value"]').val(productResponse[2]);
        row.find('[name^="product_color_"]').val(productResponse[3]);
        row.find('[name$="-product"]').val(productResponse[1]);
        row.find('[name$="-unique_serial_no"]').val(productResponse[4]);
        row.find('[name$="-bin_number"]').val(productResponse[8]);
        row.find('[name$="-bin_no"]').val(productResponse[5])
        row.find('[name$="-quantity"]').val(productResponse[6]);
        row.find('[id^="product_img_"]').attr("src", productResponse[7]);
        row.find('[name^="picklistNo_"]').val(productResponse[9])
        picklistQtyCheck()
    }

    function picklistQtyCheck() {
    var checkedRadio = $('input[name="picklistRadio"]:checked');

    if (checkedRadio.length === 0) {
        console.warn("No picklist selected.");
        $('#responseMessage').html('<span class="text-danger">Please select a picklist before calculating.</span>');
        return;
    }

    var selectedRow = checkedRadio.closest('tr'); // Get the selected row
    var pickNo = parseInt(selectedRow.find('.pickId').text().trim()); // Selected Picklist No.
    var pickQty = parseInt(selectedRow.find('.pickQty').text().trim(), 10) || 0; // Selected Picklist Quantity
   
    var total = 0; // Total outward quantity

    console.log('Selected Picklist No:', pickNo);
    console.log('Selected Picklist Qty:', pickQty);
   

    var serialNoQty = $('[name$="-quantity"]'); // All outward qty inputs

    serialNoQty.each(function () {
        var outwardQty = parseInt($(this).val(), 10) || 0;
        var row = $(this).closest('tr');
        var tablePicklistNo = parseInt(row.find('[name^="picklistNo_"]').val()) || 0;
        var tableSku = parseInt(row.find('[name$="-product"]').val())

        console.log('tableSku:', tableSku);
        

        if (outwardQty > 0 && pickNo === tablePicklistNo) {
            total += outwardQty; // Add outward quantity if conditions match
        }
    });

    console.log('Total Outward Quantity:', total);

    if (total === 0) {
        console.warn("Total outward quantity is zero.");
        $('#responseMessage').html('<span class="text-warning">Total outward quantity must be greater than zero.</span>');
        return;
    }

    if (total > pickQty) {
        console.warn("Total outward quantity exceeds picklist quantity.");
        $('#responseMessage').html('<span class="text-danger">Outward quantity cannot be greater than picklist quantity.</span>');
        return;
    }

    // Update the balance for the selected row
    selectedRow.find('.pickBalance').text(pickQty - total);
}


async function sendSerialNumber(serialNo) {
 
    var checkedRadio = $('input[name="picklistRadio"]:checked');

        if (checkedRadio.length === 0) {
            console.warn("No picklist selected.");
            $('#responseMessage').html('<span class="text-danger">Please select a picklist before scanning.</span>');
            return; // Stop execution if no radio button is checked
        }

        // Get the Picklist ID from the selected row
        var selectedRow = checkedRadio.closest('tr');
        var pickNo = parseInt(selectedRow.find('.pickId').text().trim(), 10);

        console.log('Selected Picklist No:', pickNo);

    try {
        const response = await $.ajax({
            url: '/outwardscanserialnoprocess/',
            type: 'GET',
            data: {
                serialNo: serialNo,
                pickNo: pickNo,
            },
        });
       
        if (response.products && response.products.length > 0) {
            const productResponse = response.products[0];
           console.log('productResponse = ',productResponse)
            const tableBody = $('#outwardSales .mainTableList');
            const tableRow = $('#piclistTable .mainTableList')
            let rowToPopulate = null;
            let isDuplicate = false; 
            let total = 0;
           
            const serialNo = productResponse[4]; 

            tableBody.find('tr').each(function () {
                const row = $(this);
                const inputField = row.find('[name$="-product_name_value"]');
                const serialValue = row.find('[name$="-unique_serial_no"]').val()?.trim(); 
              
                if (serialValue && serialNo === serialValue) {

                    $('#responseMessage').html('<span class="text-danger">Duplicate Serial Number.</span>');
                    isDuplicate = true;
                    return false; 
                }

                // If no duplicate is found and this row is empty, assign it
                if (!isDuplicate && inputField.val().trim() === "") {
                    rowToPopulate = row;
                    return false; 
                }
            });

        
            if (isDuplicate) {
                return;
            }
        //     var serialNoQty = $('[name$="-quantity"]');

                  
        //     serialNoQty.each(function () {
        //         var outwardQty = parseInt($(this).val()) || 0;
        //         console.log('outwardQty',outwardQty)
        //         total += outwardQty;
                
        //     });

        //    let totalBalanceZero = true;
        //    tableRow.find('tr').each(function () {
        //         const row = $(this);
        //         const balance = parseInt(row.find('.pickQty').text().trim()) || 0;
        //         // console.log('balance',balance)
        //         // console.log('total',total)
        //         if (balance !== total ) {
        //             totalBalanceZero = false;
        //             return false; // Stop if there's any balance left
        //         }
        //     });

            // if (totalBalanceZero) {
            //   alert('Picklist qty will be zero add new picklist.')
            //     console.log('No more serial numbers can be added as balance is zero.');
            //     return; // Stop further processing
            // }
            
        if (rowToPopulate) {
            populateRow(rowToPopulate, productResponse);
           
        } else {
            addNewRow();
            const newRow = tableBody.find('tr').last();
            populateRow(newRow, productResponse);
         
        }
        } else {
            console.error("No products data found in response.");
        }
        

        return response;
    } catch (error) {
        console.error("Error sending serial number:", error);
        throw error;
    }
}

function isTableEmpty() {
    //   console.log($('#outwardSales .mainTableList tr').toArray().every(row => isRowEmpty($(row))))
    return $('#outwardSales .mainTableList tr').toArray().every(row => isRowEmpty($(row)));
      }

      function isRowEmpty(row) {
          return row.find('td :input').filter(function () {
            console.log('test',$(this).val().trim() )
              return $(this).val().trim() !== "";
          }).length === 0;
      }


    function addNewRow() {
        const tableBody = document.querySelector('#outwardSales .mainTableList');

        tableBody.querySelectorAll('tr').forEach(row => {
            if (window.getComputedStyle(row).display !== 'none') {
                lastVisibleRow = row;
            }
        });

        const formCountInput = document.getElementById("id_outward_product-TOTAL_FORMS");
        const formCount = parseInt(formCountInput.value);
        const formIndex = formCount;
        const lastRow = lastVisibleRow.cloneNode(true);
        lastRow.querySelectorAll("input select").forEach(function (e) {
            e.value = "";
        });

        // Update the input name, id, and value of the last row
        const rowElement = lastRow.querySelector('.rowNo[name^="rowNo_"]');
        rowElement.id = `rowNo_${formIndex}`;
        rowElement.name = `rowNo_${formIndex}`;
        rowElement.value = formIndex + 1;
        rowElement.style.border = "none";
 
        const picklistElement = lastRow.querySelector('[name^="picklistNo_"]')
        picklistElement.id = `id_picklistNo_${formIndex}`;
        picklistElement.name = `picklistNo_${formIndex}`;
        picklistElement.value = "";

        const inputSelectElement = lastRow.querySelector('input[name$="-product_RefNo"]');
        inputSelectElement.id = `id_outward_product-${formIndex}-product_RefNo`;
        inputSelectElement.name = `outward_product-${formIndex}-product_RefNo`;
        inputSelectElement.value = "";

        const inputElement = lastRow.querySelector('input[name$="-product_name_value"]');
        inputElement.id = `id_outward_product-${formIndex}-product_name_value`;
        inputElement.name = `outward_product-${formIndex}-product_name_value`;
        inputElement.value = "";

        const colorInputElement = lastRow.querySelector('.purchase-input[name^="product_color"]');
        colorInputElement.id = `product_color_${formIndex}`;
        colorInputElement.name = `product_color_${formIndex}`;
        colorInputElement.value = "";

        const skuInputElement = lastRow.querySelector('.purchase-amount[name$="-product"]');
        skuInputElement.id = `id_outward_product-${formIndex}-product`;
        skuInputElement.name = `outward_product-${formIndex}-product`;
        skuInputElement.value = "";

        const imgElement = lastRow.querySelector('[id^="product_img_"]');
        imgElement.id = `product_img_${formIndex}`;
        imgElement.src = "";

        const serialNoElement = lastRow.querySelector('input[name$="-unique_serial_no"]');
        serialNoElement.id = `id_outward_product-${formIndex}-unique_serial_no`;
        serialNoElement.name = `outward_product-${formIndex}-unique_serial_no`;
        serialNoElement.value = '';

        const binNameElement = lastRow.querySelector('input[name$="-bin_number"]');
        binNameElement.id = `id_outward_product-${formIndex}-bin_number`;
        binNameElement.name = `outward_product-${formIndex}-bin_number`;
        binNameElement.value = '';

        const binNoElement = lastRow.querySelector('input[name$="-bin_no"]');
        binNoElement.id = `id_outward_product-${formIndex}-bin_no`;
        binNoElement.name = `outward_product-${formIndex}-bin_no`;
        binNoElement.value = '';


        const qunatityInputElement = lastRow.querySelector('[name$="-quantity"]');
        qunatityInputElement.id = `id_outward_product-${formIndex}-quantity`;
        qunatityInputElement.name = `outward_product-${formIndex}-quantity`; 
        qunatityInputElement.value="";


        formCountInput.value = formCount + 1;
        tableBody.appendChild(lastRow);
      
    }


 })

 function getVisibleRows() {
    // Select all rows that are not hidden (excluding those with display: none)
    const visibleRows = document.querySelectorAll('.mainTableList tr:not([style*="display: none"])');
    return visibleRows;
}
   function deleteRowData(){
    // Add click event listener to all delete buttons
    document.querySelectorAll('.delete-btn').forEach(function (button) {
    button.addEventListener('click', function () {
        // Find all rows in the table
        const rows =  getVisibleRows();
        console.log(rows)
        // Check if more than one row exists
        if (rows.length > 1) {
            // Find the row containing the clicked delete button
            const row = this.closest('tr');

            if (row) {
                // Find the checkbox for deletion in the row
                const checkRow = row.querySelector('.godown_deleteId[name$="-DELETE"]');

                if (checkRow) {
                    checkRow.checked = true; // Mark as checked
                    checkRow.value = 'true'; // Set the value to 'true'

                    // Optionally hide the row visually
                    row.style.display = 'none';

                    // Call functions to recalculate totals or perform other updates

                    inputCheck();
                    
                } else {
                    console.error("Checkbox for deletion not found in this row");
                }
            }
        } else {
            // If only one row remains, alert the user
            alert('Cannot delete this row; at least one row must remain.');
        }
    });
});

 
  }
  deleteRowData()
 function inputCheck(){
    document.getElementById('id_outward_no').focus();
   
    const outwardNo = document.getElementById('id_outward_no');
    const inwardNo = document.getElementById('inwordSerialNo');
    const mscanNo = document.getElementById('id_manualSerialNo')
    const submit = document.getElementById('parentFormClick')
    if(outwardNo){
        outwardNo.addEventListener('keydown',function(event){
            if(event.key === "Tab"){
                event.preventDefault()
           
                if(outwardNo.value === ''){
             
                    outwardNo.focus();
                    return;
                }else{
                    inwardNo.focus() ;
                }
              
            }
        })
    }
    
    if(inwardNo){
        inwardNo.addEventListener('keydown', function(event) {
            if (event.key === "Tab") {
                event.preventDefault();
          
                if (inwardNo.value === '' ) {
                    inwardNo.focus();
                    return;
                    
                }  
            }
        })  
    }
    if(mscanNo){
        mscanNo.addEventListener('keydown', function(event) {
            if (event.key === "Tab") {
                event.preventDefault();
          
                if (mscanNo.value === '' ) {
                    mscanNo.focus();
                    return;
                    
                }else{
                    submit.focus();
                }  
            }
        })
    }
    
    }

    inputCheck();
</script>


{% endblock body %}